{"version":3,"file":"redgoose.js","sources":["../src/js/AppHistory.js","../src/js/util.js","../src/js/preference.js","../src/js/Header.js","../src/js/Index.js","../src/js/Article.js","../src/js/etc.js","../src/js/redgoose.js"],"sourcesContent":["import $ from 'jQuery';\n\n\nexport default function AppHistory(parent) {\n\n\tconst self = this;\n\tconst $title = $('head > title');\n\n\t/**\n\t * check support\n\t *\n\t * @Return {Boolean}\n\t */\n\tfunction support()\n\t{\n\t\treturn !!history.pushState;\n\t}\n\n\t/**\n\t * Push state\n\t *\n\t * @Param {Object} env\n\t * @Param {String} title\n\t * @Param {String} url\n\t */\n\tthis.push = function(env, title, url)\n\t{\n\t\tif (!support()) return;\n\t\tif (!url) return;\n\n\t\t// change title\n\t\tif (title)\n\t\t{\n\t\t\t$title.text(title);\n\t\t}\n\n\t\thistory.pushState(\n\t\t\tenv || null,\n\t\t\ttitle || url,\n\t\t\turl\n\t\t);\n\t};\n\n\t/**\n\t * Replace state\n\t *\n\t * @Param {Object} env\n\t * @Param {String} title\n\t * @Param {String} url\n\t */\n\tthis.replace = function(env, title, url)\n\t{\n\t\tif (!support()) return;\n\t\tif (!url) return;\n\n\t\t// change title\n\t\tif (title)\n\t\t{\n\t\t\t$title.text(title);\n\t\t}\n\n\t\thistory.replaceState(\n\t\t\tenv || null,\n\t\t\ttitle || url,\n\t\t\turl\n\t\t);\n\t};\n\n\t/**\n\t * initial history pop event\n\t */\n\tthis.initPopEvent = function()\n\t{\n\t\tfunction onPopState(e)\n\t\t{\n\t\t\tconst state = e.state;\n\n\t\t\tif (state && state.type)\n\t\t\t{\n\t\t\t\tswitch (state.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'index':\n\t\t\t\t\t\t// 여기로 진입하는 조건은 목록에서 페이지가 변해서 `e.state`에 값이 들어갔기 때문에 여기에 걸리는 것이다.\n\t\t\t\t\t\t// 목록으로 돌아갈때 두가지 방식으로 돌아간다.\n\t\t\t\t\t\t// 첫번째는 `X`버튼을 눌러서 팝업을 닫고 주소만 바꾸은 방식인데 이미 팝업이 닫혀있는 상태이기 때문에 이벤트를 그대로 막아주면 된다.\n\t\t\t\t\t\t// 두번째는 뒤로가기인데 그냥두면 그대로 있기 때문에 팝업을 직접 닫아줘야한다.\n\n\t\t\t\t\t\tif (parent.mode === 'article')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (parent.article.srl)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// 팝업이 띄어진 상태라면 팝업을 닫아준다.\n\t\t\t\t\t\t\t\tparent.article.close();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!parent.index)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// 팝업이 아닌 `article`페이지에서 목록으로 넘어갔을 경우\n\t\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tcase 'article':\n\t\t\t\t\t\tif (parent.mode === 'index' && state.srl)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// 목록인 상태에서 실행된다면 `article` 열기\n\t\t\t\t\t\t\tparent.article.open(state.srl);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parent.mode === 'article' && (parent.article.srl !== state.srl))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// `article`모드이며 srl 값이 서로 다를때 `article.go()` 실행\n\t\t\t\t\t\t\tparent.article.go(state.srl);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif (parent.mode === 'article' && parent.$popup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparent.article.close();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (parent.mode === 'article' && parent.$popup)\n\t\t\t\t{\n\t\t\t\t\t// `article`상태이고 팝업이 띄어진 상태라면 팝업 닫기\n\t\t\t\t\tparent.article.close();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if (parent.mode === 'index' && parent.$popup)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 아무것도 해당되지 않으면 새로고침하기\n\t\t\tlocation.reload();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!support()) return;\n\n\t\twindow.addEventListener('popstate', onPopState);\n\t}\n}","\n/**\n * Get window size\n *\n * @return {Object}\n */\nexport function getWindowSize()\n{\n\treturn {\n\t\twidth: window.innerWidth,\n\t\theight: window.innerHeight\n\t};\n}\n\n\n/**\n * is touch device\n *\n * @return {Boolean}\n */\nexport function isTouchDevice()\n{\n\treturn 'ontouchstart' in window || navigator.maxTouchPoints;\n}\n\n\n/**\n * sleep\n *\n * @param {Number} delay\n * @return {Promise}\n */\nexport function sleep(delay)\n{\n\treturn new Promise(function(resolve) {\n\t\tif (window.timer) clearTimeout(window.timer);\n\t\twindow.timer = setTimeout(resolve, delay);\n\t});\n}\n\n\n/**\n * printf\n *\n * @param {String} str\n * @param {String} values\n */\nexport function printf(str, ...values)\n{\n\tfor (let i = 0; i < values.length; i++)\n\t{\n\t\tlet pattern = `\\\\{${i}\\\\}`;\n\t\tlet replace = new RegExp(pattern, 'g');\n\t\tstr = str.replace(replace, values[i]);\n\t}\n\treturn str;\n}","\n// set size\nexport const SIZE_MOBILE = 640;\nexport const SIZE_TABLET = 768;\nexport const SIZE_ARTICLE = 900;\n\n\n","import $ from 'jQuery';\nimport * as util from './util';\nimport * as preference from './preference';\n\n\n/**\n * Header\n */\nexport default function Header()\n{\n\tconst self = this;\n\tthis.$header = $('.layout-header');\n\tthis.$gnb = this.$header.find('.gnb');\n\n\t/**\n\t * Toggle gnb from mobile\n\t */\n\tfunction toggleGnbFromMobile()\n\t{\n\t\tself.$header.find('.toggle-gnb').on('click', function() {\n\t\t\t$(this).toggleClass('toggle-gnb-active');\n\t\t\tself.$gnb.toggleClass('gnb-active');\n\t\t});\n\t}\n\n\t/**\n\t * gnb event for touch\n\t * 터치 디바이스이며 모바일보다 큰 사이즈라면 터치 작동에 대한 대응\n\t *\n\t */\n\tfunction gnbEventForTouch()\n\t{\n\t\tif (util.isTouchDevice() && preference.SIZE_MOBILE < util.getWindowSize().width)\n\t\t{\n\t\t\tself.$gnb.find('.gnb__dep-1 > li > a').on('click', false);\n\t\t}\n\t}\n\n\n\tthis.init = function()\n\t{\n\t\tgnbEventForTouch();\n\t\ttoggleGnbFromMobile();\n\t}\n\n}","import $ from 'jQuery';\nimport Masonry from 'Masonry';\n\nimport * as util from './util';\n\n\nconst SCROLL_OFFSET = 30; // 페이지가 변화되는 스크롤 y축 위치 offset\nconst SCROLL_SPEED = 300; // 페이지 추가될때 스크롤 이동되는 속도\nconst BLOCK_DELAY = 80; // 아이템들이 추가될때 fade in 딜레이 간격\nconst LOAD_PAGE_PER_SIZE = 20; // 페이지 추가될때마다 불러올 아이템의 갯수\n\n\nexport default function Index(parent)\n{\n\tconst self = this;\n\n\t/**\n\t * PUBLIC VARIABLES\n\t */\n\n\tthis.srls = {};\n\tthis.options = {};\n\tthis.scrollTimer = null;\n\tthis.selector_articles = '#articles';\n\tthis.$index = $('.index');\n\tthis.$articles = this.$index.find('.index__articles');\n\tthis.$category = this.$index.find('.index__categories');\n\tthis.$more = this.$index.find('.index__loadMore');\n\tthis.masonry = null;\n\n\t/**\n\t * FUNCTIONS\n\t */\n\n\t/**\n\t * masonry\n\t * `masonry` 객체를 만들거나 제거한다.\n\t *\n\t * @param {Boolean} sw\n\t */\n\tfunction masonry(sw=true)\n\t{\n\t\tif(sw)\n\t\t{\n\t\t\tself.$articles.addClass('masonry');\n\t\t\tself.masonry = new Masonry(self.selector_articles, {\n\t\t\t\titemSelector: '.grid-item',\n\t\t\t\tcolumnWidth: '.grid-sizer',\n\t\t\t\ttransitionDuration : '0s',\n\t\t\t\thiddenStyle : {},\n\t\t\t\tvisibleStyle : {}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tself.$articles.removeClass('masonry');\n\t\t\tself.masonry.destroy();\n\t\t\tself.masonry = null;\n\t\t}\n\t}\n\n\t/**\n\t * more articles\n\t * 아이템을 더 불러왔을때..\n\t *\n\t * @param {Number} page\n\t * @return {Promise}\n\t */\n\tasync function moreArticles(page)\n\t{\n\t\tlet response = null;\n\n\t\t// turn on loading\n\t\tmoreButton(false);\n\n\t\t// get articles\n\t\ttry\n\t\t{\n\t\t\tresponse = await $.ajax({\n\t\t\t\turl: `${parent.options.root}/ajax/`,\n\t\t\t\ttype: 'post',\n\t\t\t\tdata: {\n\t\t\t\t\tpage,\n\t\t\t\t\tsize: self.options.size,\n\t\t\t\t\tfield: 'srl,title,category_srl,json',\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t});\n\t\t}\n\t\tcatch(e)\n\t\t{\n\t\t\talert('Server error');\n\t\t\tconsole.error(e);\n\t\t\tmoreButton(true);\n\t\t\treturn false;\n\t\t}\n\n\t\t// update index\n\t\tupdateIndex(response, true, true);\n\n\t\t// update more button\n\t\tself.$more.children('a').attr('data-next', response.nextpage);\n\n\t\t// refresh masonry layout\n\t\tif (self.masonry)\n\t\t{\n\t\t\tself.masonry.layout();\n\t\t}\n\n\t\t// turn off loading\n\t\tmoreButton(true);\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * update index\n\t *\n\t * @param {Object} res\n\t * @param {Boolean} showAnimation\n\t * @param {Boolean} useScroll\n\t */\n\tfunction updateIndex(res, showAnimation=false, useScroll=false)\n\t{\n\t\tif (!res.nextpage)\n\t\t{\n\t\t\tself.$more.remove();\n\t\t}\n\n\t\t// check articles\n\t\tif (!(res.articles && res.articles.length)) return;\n\n\t\t// make article template\n\t\tlet appendElements = res.articles.map((item, key) => {\n\t\t\tlet url = `${parent.options.root}/article/${self.options.nest || ''}${item.srl}`;\n\t\t\tlet image = `${parent.options.gooseRoot}/${item.json.thumbnail.url}`;\n\t\t\tlet className = `grid-item grid-item__hidden ${item.size_className}`;\n\t\t\treturn `<div class=\"${className}\">` +\n\t\t\t\t`<a href=\"${url}\" data-srl=\"${item.srl}\" title=\"${item.title}\">` +\n\t\t\t\t`<figure style=\"background-image: url('${image}')\">` +\n\t\t\t\t`${item.title}` +\n\t\t\t\t`</figure>` +\n\t\t\t\t`</a>` +\n\t\t\t\t`</div>`;\n\t\t}).join('');\n\n\t\t// append articles\n\t\tlet $appendElements = $(appendElements);\n\n\t\t// set event articles\n\t\tinitItemsEvent($appendElements.children('a'));\n\n\t\t// append articles\n\t\tself.$articles.append($appendElements);\n\n\t\t// append articles using masonry\n\t\tif (self.masonry)\n\t\t{\n\t\t\tself.masonry.appended($appendElements);\n\t\t}\n\n\t\t// play animation blocks\n\t\tif (showAnimation)\n\t\t{\n\t\t\tanimationBlocks($appendElements);\n\t\t}\n\n\t\t// move to next page by scroll\n\t\tif (useScroll)\n\t\t{\n\t\t\tlet $firstElement = $appendElements.eq(0);\n\t\t\tlet top = $firstElement.offset().top - SCROLL_OFFSET;\n\t\t\t$firstElement.attr('data-page', res.currentPage);\n\t\t\t$(\"html, body\").stop().animate({ scrollTop: top }, SCROLL_SPEED, 'swing');\n\t\t}\n\t}\n\n\t/**\n\t * show animation block\n\t *\n\t * @param {Object} $blocks\n\t */\n\tfunction animationBlocks($blocks)\n\t{\n\t\t$blocks.each(function(key) {\n\t\t\tsetTimeout(() => {\n\t\t\t\t$(this).removeClass('grid-item__hidden');\n\t\t\t}, BLOCK_DELAY * key);\n\t\t});\n\t}\n\n\t/**\n\t * control more button\n\t * 더 불러오기 버튼의 상태가 변한다.\n\t *\n\t * @param {Boolean} sw\n\t */\n\tfunction moreButton(sw)\n\t{\n\t\t// more load articles\n\t\tfunction loadMoreTrigger()\n\t\t{\n\t\t\tmoreArticles(this.dataset.next).then();\n\t\t\treturn false;\n\t\t}\n\n\t\tif (sw)\n\t\t{\n\t\t\tself.$more.children('a').on('click', loadMoreTrigger);\n\t\t\tself.$more.removeClass('loadMore-loading');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tself.$more.children('a').off('click');\n\t\t\tself.$more.addClass('loadMore-loading');\n\t\t}\n\t}\n\n\t/**\n\t * toggle category for mobile\n\t */\n\tfunction toggleCategory()\n\t{\n\t\t$(this).toggleClass('categories__toggle-active');\n\t\t$(this).next().toggleClass('categories__index-active');\n\t}\n\n\t/**\n\t * scroll event\n\t *\n\t * @param {Boolean} sw\n\t */\n\tfunction scrollEvent(sw)\n\t{\n\t\tif (!parent.options.dynamicChangePageNumber) return;\n\n\t\tconst delay = 100;\n\n\t\tfunction action()\n\t\t{\n\t\t\tconst $el = self.$articles.children('[data-page]');\n\t\t\tconst top = $(this).scrollTop();\n\t\t\tlet $current = null;\n\n\t\t\tif (!$el.length) return false;\n\n\t\t\tif (top + $(this).height() === $(document).height())\n\t\t\t{\n\t\t\t\t$current = ($el.eq($el.length - 1)) ? $el.eq($el.length - 1) : null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$el.each(function(key) {\n\t\t\t\t\tif (top >= ($(this).offset().top - (SCROLL_OFFSET + 5)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$current = $(this);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (!$current)\n\t\t\t\t{\n\t\t\t\t\t$current = $el.eq(0);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// update page\n\t\t\tlet page = ($current && $current.length) ? $current.data('page') : 1;\n\t\t\tupdatePage(page);\n\t\t}\n\n\t\tif (sw)\n\t\t{\n\t\t\t$(window).off('scroll.redgoose');\n\t\t\t$(window).on('scroll.redgoose', function() {\n\t\t\t\t// 너무많은 스크롤 이벤트가 트리깅 하는것을 방지하기 위하여 셋 타임아웃을 걸어놓았다.\n\t\t\t\tclearTimeout(self.scrollTimer);\n\t\t\t\tself.scrollTimer = setTimeout(action, delay);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(window).off('scroll.redgoose');\n\t\t}\n\t}\n\n\t/**\n\t * update page\n\t * 변경된 페이지 번호로 url 업데이트 한다.\n\t *\n\t * @param {Number} page\n\t */\n\tfunction updatePage(page)\n\t{\n\t\tif (!URL) return;\n\n\t\tlet url = new URL(window.location.href);\n\t\tlet urlParams = url.searchParams;\n\t\tlet urlPage = url.searchParams.get('page');\n\t\turlPage = urlPage ? parseInt(urlPage) : 1;\n\n\t\tif (page === urlPage) return;\n\n\t\tif (page === 1)\n\t\t{\n\t\t\turlParams.delete('page');\n\t\t}\n\t\telse\n\t\t{\n\t\t\turlParams.set('page', page);\n\t\t}\n\n\t\tlet newUrl = location.pathname + (urlParams.toString() ? `?${urlParams.toString()}` : '');\n\n\t\t// update url\n\t\tparent.history.replace({ url: newUrl, type: 'index' }, null, newUrl);\n\t}\n\n\t/**\n\t * init items event\n\t *\n\t * @param {Object} $items\n\t */\n\tfunction initItemsEvent($items)\n\t{\n\t\tfunction onClickArticle(e)\n\t\t{\n\t\t\tlet srl = $(this).data('srl');\n\t\t\tif (!!srl)\n\t\t\t{\n\t\t\t\tparent.article.open(srl, true).then(onArticleOpen);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction onArticleOpen()\n\t\t{\n\t\t\tself.destroyIndexEvent();\n\t\t}\n\n\t\t$items.on('click', onClickArticle);\n\t}\n\n\n\t/**\n\t * METHODS\n\t */\n\n\t/**\n\t * init\n\t *\n\t * @param {Object} options\n\t */\n\tthis.init = function(options={})\n\t{\n\t\tif (!this.$articles.length) return false;\n\n\t\t// set srls\n\t\tthis.srls.nest = options.nest_srl;\n\t\tthis.srls.category = options.category_srl;\n\n\t\t// set options\n\t\tthis.options.size = options.size || LOAD_PAGE_PER_SIZE;\n\t\tthis.options.title = options.title || parent.options.title;\n\n\t\t// set mode\n\t\tparent.mode = 'index';\n\n\t\t// set toggle category for mobile\n\t\tthis.$category.children('.categories__toggle').on('click', toggleCategory);\n\n\t\t// initial select item event\n\t\tinitItemsEvent(this.$articles.find('.grid-item > a'));\n\n\t\t// initial history pop state event\n\t\tparent.history.initPopEvent();\n\n\t\t// set masonry\n\t\tmasonry();\n\n\t\t// 페이지 이동 안되도록 주소변경\n\t\tself.$more.children('a').attr('href', 'javascript:;');\n\n\t\t// set more articles event\n\t\tmoreButton(true);\n\n\t\t// set change page sensor\n\t\tscrollEvent(true);\n\t};\n\n\t/**\n\t * push page\n\t * 특정 페이지 데이터를\n\t *\n\t * @param {Number} page\n\t */\n\tthis.pushPage = function(page)\n\t{\n\t\tmoreArticles(page).then();\n\t};\n\n\t/**\n\t * destroy index event\n\t * 목록에 관련된 이벤트를 모두 끈다.\n\t */\n\tthis.destroyIndexEvent = function()\n\t{\n\t\tif (this.masonry)\n\t\t{\n\t\t\tmasonry(false);\n\t\t}\n\t\tscrollEvent(false);\n\t};\n\n\t/**\n\t * restore index event\n\t * 목록에 관련된 이벤트를 모두 다시켠다.\n\t */\n\tthis.restoreIndexEvent = function()\n\t{\n\t\tif (!this.masonry)\n\t\t{\n\t\t\tmasonry(true);\n\t\t}\n\t\tscrollEvent(true);\n\t};\n\n\t/**\n\t * use masonry\n\t * masonry 사용할지 안할지에 대한 공개 메서드\n\t *\n\t * @param {Boolean} sw\n\t */\n\tthis.useMasonry = function(sw)\n\t{\n\t\tmasonry(sw);\n\t};\n\n\t/**\n\t * scroll event\n\t *\n\t * @param {Boolean} sw\n\t */\n\tthis.useScrollEvent = function(sw)\n\t{\n\t\tscrollEvent(sw);\n\t};\n\n}","import $ from 'jQuery';\nimport AppHistory from './AppHistory';\n\nimport * as util from './util';\n\n\nconst transitionDelay = 300;\n\n\nexport default function Article(parent)\n{\n\tconst self = this;\n\tconst $html = $('html');\n\n\t/**\n\t * PUBLIC VARIABLES\n\t */\n\n\tthis.backupIndexScrollTop = 0;\n\tthis.$close = null;\n\tthis.$prev = null;\n\tthis.$next = null;\n\tthis.$like = null;\n\tthis.$body = null;\n\tthis.srl = null;\n\n\n\t/**\n\t * FUNCTIONS\n\t */\n\n\t/**\n\t * open\n\t *\n\t * @param {Number} srl\n\t * @param {Boolean} useHistory\n\t * @return {Promise}\n\t */\n\tasync function open(srl, useHistory=false)\n\t{\n\t\t// check mode\n\t\tif (parent.mode !== 'index')\n\t\t{\n\t\t\talert(`It is not currently in 'index' mode.`);\n\t\t\treturn;\n\t\t}\n\n\t\t// change mode\n\t\tparent.mode = 'article';\n\n\t\t// save scroll position\n\t\tself.backupIndexScrollTop = $(window).scrollTop();\n\n\t\t// interaction\n\t\tparent.$popup.addClass('popupArticle-show');\n\t\tparent.$app.addClass('disabled');\n\t\twindow.scrollTo(0, 0);\n\n\t\t// go to article\n\t\tgo(srl, useHistory, 'push').then();\n\t}\n\n\t/**\n\t * close\n\t *\n\t * @param {Boolean} useHistory\n\t * @return {Promise}\n\t */\n\tasync function close(useHistory=false)\n\t{\n\t\t// check mode\n\t\tif (parent.mode !== 'article')\n\t\t{\n\t\t\talert(`It is not currently in 'article' mode.`);\n\t\t\treturn;\n\t\t}\n\n\t\t// change mode\n\t\tparent.mode = 'index';\n\n\t\tif (useHistory)\n\t\t{\n\t\t\twindow.history.back();\n\t\t}\n\n\t\t// set srl\n\t\tself.srl = null;\n\n\t\t// 팝업으로 띄어져 있는 상태라면..\n\t\tif (parent.$popup && parent.$popup.length)\n\t\t{\n\t\t\tparent.$app.removeClass('disabled').addClass('hidden');\n\t\t\tparent.$popup.removeClass('popupArticle-show').empty();\n\t\t\tparent.index.restoreIndexEvent();\n\n\t\t\tawait util.sleep(10);\n\n\t\t\t// 팝업이 열려있는 상태에서 윈도우 사이즈를 변경하고 닫으면 레이아웃이 깨지기 때문에 `layout()`메서드를 실행하여 다시 잡아줘야함.\n\t\t\tif (parent.index)\n\t\t\t{\n\t\t\t\tparent.index.masonry.layout();\n\t\t\t}\n\n\t\t\tawait util.sleep(10);\n\n\t\t\t$('html,body').scrollTop(self.backupIndexScrollTop);\n\t\t\tself.backupIndexScrollTop = 0;\n\n\t\t\tparent.$app.removeClass('hidden');\n\t\t}\n\n\t\t// change title\n\t\tdocument.title = parent.index.options.title;\n\t}\n\n\t/**\n\t * go to article\n\t *\n\t * @param {Number} srl\n\t * @param {Boolean} useHistory\n\t * @param {String} historyMethod `push|replace`\n\t * @return {Promise}\n\t */\n\tfunction go(srl, useHistory=false, historyMethod='push')\n\t{\n\t\treturn new Promise(function(resolve) {\n\t\t\tconst url = `${parent.options.root}/article/${srl}/`;\n\n\t\t\tif (!parent.$popup) return;\n\n\t\t\t// on loading\n\t\t\tloading(true);\n\n\t\t\t// set srl\n\t\t\tself.srl = srl;\n\n\t\t\t// clear contents\n\t\t\tparent.$popup.empty();\n\n\t\t\t// load article page\n\t\t\tparent.$popup.load(`${url}?mode=popup`, (el) => {\n\t\t\t\tlet $el = $(el);\n\t\t\t\tlet title = $el.find('.article__header > h1').text();\n\t\t\t\ttitle = !!title ? `${parent.options.title} / ${title}` : parent.options.title;\n\n\t\t\t\t// setting elements in article\n\t\t\t\tself.$body = $('#article');\n\t\t\t\tself.$close = $('#closeArticle');\n\t\t\t\tself.$prev = $('#goToPrevArticle');\n\t\t\t\tself.$next = $('#goToNextArticle');\n\t\t\t\tself.$like = $('#toggleLike');\n\n\t\t\t\t// initial event in article\n\t\t\t\tinitCloseEvent();\n\t\t\t\tinitLikeEvent();\n\t\t\t\tinitMoveArticleEvent();\n\n\t\t\t\t// push history\n\t\t\t\tif (useHistory)\n\t\t\t\t{\n\t\t\t\t\tif (parent.options.dev) console.warn('change url:', url, historyMethod);\n\t\t\t\t\tparent.history[historyMethod || 'push']({ url, srl, type: 'article' }, title, url);\n\t\t\t\t}\n\n\t\t\t\t// off loading\n\t\t\t\tloading(false);\n\n\t\t\t\t// exit\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * initial close event\n\t */\n\tfunction initCloseEvent(sw=true)\n\t{\n\t\tif (sw)\n\t\t{\n\t\t\tself.$close.on('click', () => close(true));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tself.$close.off('click');\n\t\t}\n\t}\n\n\t/**\n\t * initial move article event\n\t */\n\tfunction initMoveArticleEvent(sw=true)\n\t{\n\t\tfunction action()\n\t\t{\n\t\t\tself.go(this.dataset.srl, true, 'replace');\n\t\t\treturn false;\n\t\t}\n\n\t\tif (sw)\n\t\t{\n\t\t\tself.$prev.on('click', action);\n\t\t\tself.$next.on('click', action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tself.$prev.off('click');\n\t\t\tself.$next.off('click');\n\t\t}\n\t}\n\n\t/**\n\t * initial like event\n\t */\n\tfunction initLikeEvent()\n\t{\n\t\tasync function send(srl)\n\t\t{\n\t\t\tif (!srl) return null;\n\n\t\t\treturn await $.ajax({\n\t\t\t\turl: `${parent.options.root}/ajax/uplike/`,\n\t\t\t\ttype: 'post',\n\t\t\t\theaders: { 'redgoose-action': 'uplike' },\n\t\t\t\tdata: { srl },\n\t\t\t\tdataType: 'json',\n\t\t\t});\n\t\t}\n\n\t\tfunction onClickEvent()\n\t\t{\n\t\t\tconst $em = self.$like.children('em');\n\t\t\tlet srl = this.dataset.srl;\n\t\t\tlet n = parseInt($em.text());\n\n\t\t\t// change button\n\t\t\tself.$like.addClass('onLike-on').off();\n\t\t\t$em.text(n + 1);\n\n\t\t\t// request\n\t\t\tsend(srl).then(function(res) {\n\t\t\t\tswitch(res.state)\n\t\t\t\t{\n\t\t\t\t\tcase 'success':\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t$em.text(n);\n\t\t\t\t\t\tself.$like.removeClass('onLike-on').on('click', onClickEvent);\n\t\t\t\t\t\tconsole.error(res.message);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// set event\n\t\tif (!self.$like.hasClass('onLike-on'))\n\t\t{\n\t\t\tself.$like.on('click', onClickEvent);\n\t\t}\n\t}\n\n\t/**\n\t * loading\n\t *\n\t * @param {Boolean} sw\n\t */\n\tfunction loading(sw=false)\n\t{\n\n\t}\n\n\n\t/**\n\t * METHODS\n\t */\n\n\t/**\n\t * open article\n\t *\n\t * @param {Number} srl\n\t * @param {Boolean} useHistory\n\t *\n\t */\n\tthis.open = async function(srl, useHistory=false)\n\t{\n\t\tawait open(srl, useHistory);\n\t};\n\n\t/**\n\t * close article\n\t *\n\t * @param {Boolean} useHistory\n\t * @return {Promise}\n\t */\n\tthis.close = async function(useHistory)\n\t{\n\t\tawait close(useHistory);\n\t};\n\n\t/**\n\t * go to article\n\t *\n\t * @param {Number} srl\n\t * @param {Boolean} useHistory\n\t * @param {String} historyMethod\n\t */\n\tthis.go = function(srl, useHistory, historyMethod='push')\n\t{\n\t\tif (!srl)\n\t\t{\n\t\t\talert(`not found 'srl'`);\n\t\t\treturn;\n\t\t}\n\n\t\t// check srl and mode\n\t\tif (parent.mode === 'article' && parent.index && parent.$popup)\n\t\t{\n\t\t\tgo(srl, useHistory, historyMethod).then();\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location.href = `${parent.options.root}/article/${srl}/`;\n\t\t}\n\t};\n\n\t/**\n\t * init\n\t * 단독 article페이지를 열었을때 사용되는 메서드\n\t */\n\tthis.init = function(options)\n\t{\n\t\t// remove index instance\n\t\tdelete parent.index;\n\t\tdelete parent.popup;\n\t\tdelete parent.$popup;\n\n\t\t// set options\n\t\tthis.srl = options.srl;\n\n\t\t// set mode\n\t\tparent.mode = 'article';\n\n\t\t// setting elements in article\n\t\tthis.$body = $('#article');\n\t\tthis.$prev = $('#goToPrevArticle');\n\t\tthis.$next = $('#goToNextArticle');\n\t\tthis.$like = $('#toggleLike');\n\n\t\t// initial history pop state event\n\t\tparent.history.initPopEvent();\n\n\t\t// initial events;\n\t\tinitLikeEvent();\n\t};\n\n}","\n// default options\nexport const defaultOptions = {\n\troot: '',\n\tgooseRoot: '',\n\tdynamicChangePageNumber: true,\n\tdev: false,\n};\n\n\n/**\n * init google analytics\n *\n * @param {Boolean} sw\n */\nexport function initGoogleAnalytics(sw)\n{\n\tif (!sw) return null;\n\n\t// Google Analytics\n\t(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n\t\t(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n\t\tm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n\t})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\tga('create', 'UA-42563094-1', 'redgoose.me');\n\tga('send', 'pageview');\n}\n","import $ from 'jQuery';\nimport AppHistory from './AppHistory';\nimport Header from './Header';\nimport Index from './Index';\nimport Article from './Article';\nimport * as etc from './etc';\nimport * as util from './util';\n\n\n/**\n * Redgoose\n *\n * @param {Object} options\n */\nfunction Redgoose(options)\n{\n\tthis.$app = $('main');\n\tthis.popup = 'popupArticle';\n\tthis.$popup = $(`#${this.popup}`);\n\tthis.mode = null;\n\n\t// assign options\n\tthis.options = Object.assign({}, etc.defaultOptions, options);\n\n\t// init history\n\tthis.history = new AppHistory(this);\n\n\t// init header\n\tthis.header = new Header(this);\n\n\t// init index\n\tthis.index = new Index(this);\n\n\t// init article\n\tthis.article = new Article(this);\n\n\t// set touch device\n\tif (util.isTouchDevice())\n\t{\n\t\t$('html').addClass('touch');\n\t}\n\n\t// init google analytics\n\tetc.initGoogleAnalytics(!options.dev);\n}\n\n\nexport default Redgoose;"],"names":["AppHistory","parent","$title","$","support","history","pushState","push","env","title","url","text","replace","replaceState","initPopEvent","onPopState","e","state","type","mode","article","srl","close","index","reload","open","go","$popup","addEventListener","getWindowSize","window","innerWidth","innerHeight","isTouchDevice","navigator","maxTouchPoints","sleep","delay","Promise","resolve","timer","clearTimeout","setTimeout","SIZE_MOBILE","Header","self","$header","$gnb","find","toggleGnbFromMobile","on","toggleClass","gnbEventForTouch","util","preference","width","init","SCROLL_OFFSET","SCROLL_SPEED","BLOCK_DELAY","LOAD_PAGE_PER_SIZE","Index","page","response","ajax","options","root","size","error","$more","children","attr","nextpage","masonry","layout","moreArticles","srls","scrollTimer","selector_articles","$index","$articles","$category","sw","addClass","Masonry","removeClass","destroy","updateIndex","res","showAnimation","useScroll","remove","articles","length","appendElements","map","item","key","nest","image","gooseRoot","json","thumbnail","className","size_className","join","$appendElements","append","appended","$firstElement","eq","top","offset","currentPage","stop","animate","scrollTop","animationBlocks","$blocks","each","moreButton","loadMoreTrigger","dataset","next","then","off","toggleCategory","scrollEvent","dynamicChangePageNumber","action","$el","$current","height","document","data","updatePage","URL","location","href","urlParams","searchParams","urlPage","get","parseInt","delete","set","newUrl","pathname","toString","initItemsEvent","$items","onClickArticle","onArticleOpen","destroyIndexEvent","nest_srl","category","category_srl","pushPage","restoreIndexEvent","useMasonry","useScrollEvent","Article","useHistory","backupIndexScrollTop","$app","scrollTo","back","empty","$html","$close","$prev","$next","$like","$body","historyMethod","load","el","dev","console","warn","initCloseEvent","initMoveArticleEvent","initLikeEvent","send","onClickEvent","$em","n","message","hasClass","popup","defaultOptions","initGoogleAnalytics","i","s","o","g","r","a","m","q","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","Redgoose","Object","assign","etc","header"],"mappings":"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"}